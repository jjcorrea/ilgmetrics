{% extends "commons/base.html" %}

{% block extrahead %}

<script type="text/javascript">
$(function () {
	    //$('#datatable').dataTable();
	    $('.datepick').datepicker({ dateFormat: "dd/mm/yy" });
	
	    /*
	    	
	    $('#stacked').highcharts({
            chart: {
                type: 'bar'
            },
            title: {
                text: 'Services share'
            },
            xAxis: {
                categories: ['Alert', 'Autocomplete', 'Chemistry', 'Export', 'Export-Investex', 'Export-Search', 'Ontology', 'Retrieve', 'Retrieve-Regulatory', 'Search', 'Storage', 'TI Wrapper']
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Services share per team'
                }
            },
            legend: {
                backgroundColor: '#FFFFFF',
                reversed: true
            },
            plotOptions: {
                series: {
                    stacking: 'normal'
                }
            },
                series: [
            {
                name: 'SPARTA',
                data: [2, 2, 3, 2, 1, 0, 0, 0, 0, 0, 0, 0]
            }, {
                name: 'KOALA',
                data: [3, 4, 4, 2, 5, 0, 0, 0, 0, 0, 0, 0]
            },{
                name: 'DRIVE',
                data: [5, 3, 4, 7, 2, 0, 0, 0, 0, 0, 0, 0]
            },
            {
                name: 'BARCELONA',
                data: [3, 4, 4, 2, 5, 0, 0, 0, 0, 0, 0, 0]
            }]
        });	    
	    */
	    
	   	// workstream share
	    $('#workstream').highcharts({
	        chart: {
	            plotBackgroundColor: null,
	            plotBorderWidth: null,
	            plotShadow: false
	        },
	        title: {
	            text: 'Workstream Share'
	        },
	        tooltip: {
	    	    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
	        },
	        plotOptions: {
	            pie: {
	                allowPointSelect: true,
	                cursor: 'pointer',
	                dataLabels: {
	                    enabled: true,
	                    color: '#000000',
	                    connectorColor: '#000000',
	                    format: '<b>{point.name}</b>: {point.percentage:.1f} %'
	                }
	            }
	        },
	        series: [{
	            type: 'pie',
	            name: 'Workstream share',
	            data: [
					{% for key,value in workstream_share.items %}
						['{{key}}', {{value}}],
					{% endfor %}
	            ]
	        }]
	    });
	
	
});
</script>
{% endblock %}

{% block content %}
	<div id="workstream"></div>

	<br /><br />

	<div class="panel overall-status">
	  <div class="panel-heading">Release 13.3 - Overall status</div>
		<ul class="list-group list-group-flush">
		    <li class="list-group-item fail">BARCELONA <span class="label label-warning">1 week + 2 days + 4h delay</span></li>
		    <li class="list-group-item ok">DRIVE</li>
		    <li class="list-group-item ok">SPARTA</li>
		    <li class="list-group-item ok">KOALA</li>
		  </ul>	  
	</div>

	<br />

	<div class='span4 shiftleft'>
		<h4 class='text-info text-center'>Story</h4>
		<table class="table table-condensed table-striped">
              <thead>
                <tr>
                  <th class='centered'>Points</th>
                  <th class='centered'>Design</th>
                  <th class='centered'>Test & Code</th>
                  <th class='centered'>Code Review</th>
                  <th class='centered'>Block</th>
                  <th class='centered'>Acceptance</th>
                </tr>
              </thead>
              <tbody>
				{% for raw_story in global_metrics.story_grid %}
					<tr>
					{%for story in raw_story%}
						<td class='{%if forloop.counter == 1%}story_points{%endif%} centered'>{{story}}</td>
					{%endfor%}
					</tr>
				{% endfor %}
              </tbody>
            </table>	
	</div>
	
	<div class='span4'>
		<h4 class='text-info text-center'>Bug</h4>
		<table class="table table-condensed table-striped text-center">
              <thead>
                <tr>
                  <th class='centered'>Points</th>
                  <th class='centered'>Design</th>
                  <th class='centered'>Test & Code</th>
                  <th class='centered'>Code Review</th>
                  <th class='centered'>Block</th>
                  <th class='centered'>Acceptance</th>
                </tr>
              </thead>
              <tbody>
				{% for raw_bug in global_metrics.bug_grid %}
					<tr>
					{%for bug in raw_bug%}
						<td class='{%if forloop.counter == 1%}story_points{%endif%} centered'>{{bug}}</td>
					{%endfor%}
					</tr>
				{% endfor %}

              </tbody>
            </table>	
	</div>	
	
	<br />
{% endblock %}
